## 4.1 군집 모델이란?

**정의**: 레이블 없이 데이터의 유사성 기반으로 그룹화

### 특징

|항목|내용|
|---|---|
|목적|데이터 내 숨겨진 패턴/구조 발견|
|입력|레이블 없는 데이터 (X만 존재)|
|출력|각 데이터의 군집 할당|

### 활용 분야

- 고객 세분화 (마케팅)
- 이상 탐지
- 이미지 분할
- 문서 분류
- 추천 시스템

## 4.2 계층적 군집 알고리즘 (Hierarchical Clustering)

**원리**: 데이터를 계층적 트리(덴드로그램) 구조로 군집화

### 방식

|방식|설명|
|---|---|
|병합형 (Agglomerative)|개별 → 점진적 병합 (Bottom-Up)|
|분할형 (Divisive)|전체 → 점진적 분할 (Top-Down)|

### 연결 방법 (Linkage)

|방법|기준|특징|
|---|---|---|
|Single|최소 거리|사슬 효과 발생 가능|
|Complete|최대 거리|구형 군집 선호|
|Average|평균 거리|균형 잡힌 방식|
|Ward|분산 최소화|크기 비슷한 군집 생성|

### 덴드로그램

```
        ┌───────┴───────┐
    ┌───┴───┐       ┌───┴───┐
  ┌─┴─┐   ┌─┴─┐   ┌─┴─┐   ┌─┴─┐
  A   B   C   D   E   F   G   H
  
  ↑ 절단 위치에 따라 군집 수 결정
```

### 장단점

|장점|단점|
|---|---|
|K 사전 지정 불필요|계산 복잡도 높음 O(n³)|
|덴드로그램으로 시각화|대용량 데이터에 부적합|
|다양한 군집 수 탐색 가능|한번 병합/분할 시 취소 불가|

## 4.3 K-Means 알고리즘

**원리**: K개 중심점(centroid) 기준으로 가장 가까운 군집에 할당

### 알고리즘 순서

```
1. K개 초기 중심점 무작위 설정
        ↓
2. 각 데이터를 가장 가까운 중심점에 할당
        ↓
3. 각 군집의 평균으로 중심점 업데이트
        ↓
4. 중심점 변화 없을 때까지 2-3 반복
```

### 주요 파라미터

|파라미터|설명|
|---|---|
|n_clusters (K)|군집 수|
|init|초기화 방법 (k-means++, random)|
|max_iter|최대 반복 횟수|
|n_init|초기화 반복 횟수|

### K 선택 방법

|방법|설명|
|---|---|
|엘보우 방법|Inertia 감소율이 꺾이는 지점|
|실루엣 점수|최대 실루엣 점수의 K 선택|

### 장단점

|장점|단점|
|---|---|
|단순하고 빠름 O(nKt)|K 사전 지정 필요|
|대용량 데이터 처리 가능|구형 군집만 탐지|
|해석 용이|초기값에 민감|
||이상치에 민감|

### K-Means 변형

|모델|특징|
|---|---|
|K-Means++|초기 중심점 개선|
|Mini-Batch K-Means|샘플링으로 속도 향상|
|K-Medoids|중심을 실제 데이터로 (이상치 강건)|

## 4.4 군집 알고리즘의 평가 방법

### 내부 평가 (레이블 없음)

|지표|설명|범위|
|---|---|---|
|실루엣 점수|응집도와 분리도 측정|-1 ~ 1 (높을수록 좋음)|
|Inertia (SSE)|군집 내 거리 제곱합|낮을수록 좋음|
|Davies-Bouldin|군집 간 유사도|낮을수록 좋음|
|Calinski-Harabasz|군집 간/내 분산 비율|높을수록 좋음|

### 실루엣 점수 계산

```
s(i) = (b(i) - a(i)) / max(a(i), b(i))

a(i) : 같은 군집 내 평균 거리
b(i) : 가장 가까운 다른 군집까지 평균 거리
```

### 외부 평가 (레이블 있음)

|지표|설명|
|---|---|
|ARI (Adjusted Rand Index)|우연 보정된 쌍 일치도|
|NMI (Normalized Mutual Information)|정규화된 상호 정보량|
|Homogeneity|군집 내 동질성|
|Completeness|같은 클래스가 같은 군집에|

### 평가 시 고려사항

- 단일 지표보다 여러 지표 종합 판단
- 비즈니스 맥락에서 해석 가능성 검토
- 시각화로 군집 품질 확인 (t-SNE, PCA)

코드를 실행하려면 설정 > 기능에서 코드 실행 및 파일 생성을 활성화하세요.