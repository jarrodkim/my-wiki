# 3장. 지도학습

## 3.1 의사결정나무 (Decision Tree)

**원리**: 특성 기준으로 데이터를 재귀적 분할하여 트리 구조 생성

### 주요 개념

|용어|설명|
|---|---|
|루트 노드|최상위 분할 지점|
|리프 노드|최종 예측값|
|분할 기준|지니 불순도, 엔트로피, 정보이득|
|가지치기|과적합 방지를 위한 트리 축소|

### 장단점

|장점|단점|
|---|---|
|해석 용이|과적합 경향|
|전처리 최소화|불안정성 (데이터 변화에 민감)|
|비선형 관계 학습|축에 평행한 분할만 가능|

## 3.2 앙상블 (Ensemble)

**원리**: 여러 모델을 결합하여 성능 향상

### 앙상블 기법 비교

|모델|방식|특징|
|---|---|---|
|Random Forest|배깅|여러 트리의 다수결/평균, 병렬 학습|
|XGBoost|부스팅|순차 학습, 정규화 내장, 결측치 자동 처리|
|LightGBM|부스팅|Leaf-wise 성장, 대용량에 빠름, 메모리 효율|

### 배깅 vs 부스팅

```
배깅(Bagging)          부스팅(Boosting)
├── 병렬 학습           ├── 순차 학습
├── 분산 감소           ├── 편향 감소
└── 독립적 샘플링       └── 오차에 가중치 부여
```

### 주요 하이퍼파라미터

|파라미터|설명|
|---|---|
|n_estimators|트리 개수|
|max_depth|최대 깊이|
|learning_rate|학습률 (부스팅)|
|min_samples_split|분할 최소 샘플 수|

## 3.3 KNN (K-Nearest Neighbor)

**원리**: K개 최근접 이웃의 다수결(분류) 또는 평균(회귀)

### 특징

|항목|내용|
|---|---|
|거리 척도|유클리드, 맨해튼, 민코프스키|
|K 선택|작으면 과적합, 크면 과소적합|
|특징|게으른 학습(Lazy Learning), 학습 단계 없음|

### 장단점

|장점|단점|
|---|---|
|단순하고 직관적|고차원에서 성능 저하|
|비선형 경계 학습|예측 속도 느림|
|학습 시간 없음|스케일링 필수|

## 3.4 SVM (Support Vector Machine)

**원리**: 클래스 간 마진을 최대화하는 초평면 탐색

### 주요 개념

|용어|설명|
|---|---|
|서포트 벡터|결정 경계에 가장 가까운 데이터|
|마진|서포트 벡터와 경계 사이 거리|
|커널 트릭|고차원 매핑으로 비선형 분류|
|C (규제)|작으면 소프트 마진, 크면 하드 마진|

### 커널 종류

|커널|용도|
|---|---|
|Linear|선형 분리 가능|
|RBF|범용, 비선형|
|Polynomial|다항식 경계|

## 3.5 로지스틱 회귀 (Logistic Regression)

**원리**: 시그모이드 함수로 확률 출력 → 분류

### 수식

```
P(Y=1) = 1 / (1 + e^(-z))
z = w₀ + w₁x₁ + w₂x₂ + ...
```

### 특징

|항목|내용|
|---|---|
|출력|0~1 확률값|
|손실 함수|Binary Cross-Entropy|
|다중 분류|One-vs-Rest, Softmax|
|규제|L1(Lasso), L2(Ridge)|

## 3.6 선형 회귀 (Linear Regression)

**원리**: 독립변수와 종속변수의 선형 관계 모델링

### 수식

```
Y = w₀ + w₁x₁ + w₂x₂ + ... + ε
```

### 종류

|모델|규제|특징|
|---|---|---|
|단순 선형|없음|기본 모델|
|릿지(Ridge)|L2|가중치 축소, 다중공선성 해결|
|라쏘(Lasso)|L1|특성 선택 (일부 가중치 0)|
|ElasticNet|L1+L2|릿지+라쏘 결합|

### 가정

- 선형성, 독립성, 등분산성, 정규성

## 3.7 평가 지표

### 분류 지표

|지표|공식|설명|
|---|---|---|
|정확도(Accuracy)|(TP+TN) / 전체|전체 정답 비율|
|정밀도(Precision)|TP / (TP+FP)|예측 Positive 중 실제 Positive|
|재현율(Recall)|TP / (TP+FN)|실제 Positive 중 예측 Positive|
|F1-Score|2×(P×R)/(P+R)|정밀도-재현율 조화평균|
|AUC-ROC|-|임계값 변화에 따른 성능 곡선|

### 혼동 행렬 (Confusion Matrix)

```
              예측
            P     N
실제  P    TP    FN
      N    FP    TN
```

### 회귀 지표

|지표|공식|특징|
|---|---|---|
|MAE|Σ\|y-ŷ\| / n|평균 절대 오차|
|MSE|Σ(y-ŷ)² / n|큰 오차에 민감|
|RMSE|√MSE|MSE와 단위 일치|
|R²|1 - (SSR/SST)|설명력 (1에 가까울수록 좋음)|
|MAPE|Σ\|(y-ŷ)/y\| / n|백분율 오차|